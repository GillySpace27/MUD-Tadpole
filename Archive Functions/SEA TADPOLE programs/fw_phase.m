function last_frame = fw_phase(dcam,refspeck,cal);% fw_phase for looking at SEA TADPOLE retrievals in realtime%%   last_frame = fw_preview(dcam,n) previews a digital camera dcam for n%   frames, and returns the the last recorded frame.  The camera must be%   initialized using fw_init first.%%%% Options%%%Reference Phaseif skip == false;    lam = lam_axis(cal, length(sum(refspeck)));    omega = ltow(lam)-ltow(800);    phiref = 2.18*1e3.*omega.^3 -464.*omega.^2;end%%%%%% Code starts hereclose allfigure('WindowButtonDownFcn',@click_callback);global no_click;no_click = true;n = 0;while no_click    n= n+1;    dat = fw_snap(dcam);    k = 1;    subplot(2,1,1)    title(n);    [t, et] = find_et(phi, spectrum,cal);    m = 500;    plot_et(t(m:end-m),et(m:end-m));    subplot(2,1,2)    [phi,spec]= find_phi(dat,bg);    lam = lam_axis(cal,length(phi));    plot_ew(lam,spectrum,phi);endlast_frame = dat;clear this_frame;function click_callback(src,eventdata)global no_click;disp('Stopping the camera...');no_click = false;endend